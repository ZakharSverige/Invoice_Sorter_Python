## üöÄ –ü—Ä–æ–µ–∫—Ç: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ü–ª–∞—Ç–µ–∂–Ω–æ–π –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
**üè¢ –ö–æ–Ω—Ç–µ–∫—Å—Ç –ó–∞–∫–∞–∑—á–∏–∫–∞ –∏ –ü—Ä–æ–±–ª–µ–º–∞**
**–ó–∞–∫–∞–∑—á–∏–∫: –û–û–û "–ê—Ç–ª–∞–Ω—Ç–∏—Å"**
**–°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –£—Å–ª—É–≥–∏ –ø–æ –ø–æ—á—Ç–æ–≤–æ–π –∏ –∫—É—Ä—å–µ—Ä—Å–∫–æ–π —Å–≤—è–∑–∏.**

|  |–î–æ –ü—Ä–æ–µ–∫—Ç–∞ (AS-IS)|
| --- | --- |
|**–í—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ:** |  –û–∫–æ–ª–æ 200 000 PDF-—Ñ–∞–π–ª–æ–≤ –ø–ª–∞—Ç–µ–∂–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –ø–æ –ø–æ—á—Ç–æ–≤—ã–º –∏–Ω–¥–µ–∫—Å–∞–º. |
|**–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:** |–†—É—á–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —ç—Ç–∏—Ö 200 000 —Ñ–∞–π–ª–æ–≤ –∏–∑ –µ–¥–∏–Ω–æ–π –±–∞–∑—ã –ø–æ –∑–æ–Ω–∞–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤. | 
|**–ö–ª—é—á–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** |–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ç–µ–Ω–¥–µ—Ä–∞ |–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤—ã—Å–æ–∫–∏–π —Ä—É—á–Ω–æ–π —Ç—Ä—É–¥. 5 –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Ç—Ä–∞—Ç–∏–ª–∏ 3 –ø–æ–ª–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è –Ω–∞ –ø–µ—Ä–≤–∏—á–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º –∏ –µ—â–µ 5 —Å—É—Ç–æ–∫ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ –∫—É—Ä—å–µ—Ä–∞–º. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –æ—à–∏–±–∫–∞–º, –ø–µ—Ä–µ—Å–æ—Ä—Ç—É –∏ –∑–∞–¥–µ—Ä–∂–∫–∞–º. | 
|**–ü—Ä—è–º—ã–µ —Ä–∞—Å—Ö–æ–¥—ã:** |–ü—Ä–æ—Ü–µ–Ω—Ç —Å–Ω–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã | 40 000 ‚ÇΩ –µ–∂–µ–º–µ—Å—è—á–Ω–æ (5 —á–µ–ª–æ–≤–µ–∫ * 20 —á–∞—Å–æ–≤ * 400 ‚ÇΩ/—á–∞—Å) —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É, –±–µ–∑ —É—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫.|

___
üéØ **–ü–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –ó–∞–¥–∞—á–∞**
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥–µ–∂–Ω–æ–µ –∏ –±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ 200 000 PDF-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å —Ä—É—á–Ω–æ–π —Ç—Ä—É–¥, –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –û–û–û "–ê—Ç–ª–∞–Ω—Ç–∏—Å".
___
**üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ –∏ –†–∞–∑–≤–∏—Ç–∏–µ (–ú–æ–∏ –î–µ–π—Å—Ç–≤–∏—è)**
–í —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ —è —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –æ–±—ä–µ–¥–∏–Ω—è—é—â–µ–µ —Å–∫—Ä–∏–ø—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é SQL.

## –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è

| ‚Ññ | –≠—Ç–∞–ø / —Ä–∞–∑–≤–∏—Ç–∏–µ           | –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π |
|---|---------------------------|------------------------|
| 1 | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —è–¥—Ä–∞ —Å–∫—Ä–∏–ø—Ç–∞  | –°–æ–∑–¥–∞–Ω Python-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (RegEx) –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—É–ª–∏—Ü–∞, –¥–æ–º, –∫–æ—Ä–ø—É—Å, —Å—Ç—Ä–æ–µ–Ω–∏–µ) –∏–∑ –∏–º–µ–Ω–∏ –∫–∞–∂–¥–æ–≥–æ –∏–∑ ~200 000 PDF‚Äë—Ñ–∞–π–ª–æ–≤. |
| 2 | –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è   | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ—á–µ—Ç–∫–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (matching) –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –º–∞—Å—Ç–µ—Ä-–¥–∞–Ω–Ω—ã–º–∏ –≤ CSV‚Äë—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞—Ö (–∫–∞—Ä—Ç—ã –∫—É—Ä—å–µ—Ä—Å–∫–∏—Ö –∑–æ–Ω). –î–æ–±–∏–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫—É—Ä—å–µ—Ä—É. |
| 3 | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (SQL)  | –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω SQL‚Äë—Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—ã—Ä—ã—Ö –∞–¥—Ä–µ—Å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É. –≠—Ç–æ –ø–æ–≤—ã—Å–∏–ª–æ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ —É–ª—É—á—à–∏–ª–æ –∫–∞—á–µ—Å—Ç–≤–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è. |
| 4 | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∞       | –û–±–µ—Å–ø–µ—á–∏–≤–∞–ª –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–µ—à–µ–Ω–∏—è: –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ª–æ–≥–∏–∫—É RegEx –∏ –ø—Ä–∞–≤–∏–ª–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∑–∞–Ω–∏–º–∞–ª—Å—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –æ—Ç–ª–∞–¥–∫–æ–π –æ—à–∏–±–æ–∫. |
| 5 | –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ     | –ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∏ –ø—Ä–æ–≤—ë–ª –æ–±—É—á–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ (5 —á–µ–ª–æ–≤–µ–∫) –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏ –±—ã—Å—Ç—Ä–æ –≤—Å—Ç—Ä–æ–∏—Ç—å –µ–≥–æ –≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∫–æ–º–ø–∞–Ω–∏–∏. |
___
üìù **Python Script**
``` python
import os
import shutil
import pandas as pd
import re

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º SyntaxError)
def normalize_address_string(address_str):
    address_str = str(address_str).lower()
    address_str = re.sub(r'\s+', ' ', address_str)
    address_str = re.sub(r'(\d+)\s+([–∞-—è–ê-–Ø—ë–Åa-zA-Z])', r'\1\2', address_str)
    address_str = address_str.replace('—É–ª.', ' ').replace('—É–ª–∏—Ü–∞ ', ' ')
    address_str = address_str.replace('–¥.', ' ').replace('–¥–æ–º ', ' ')
    address_str = address_str.replace('–ø–µ—Ä.', ' ').replace('–ø–µ—Ä–µ—É–ª–æ–∫ ', ' ')
    address_str = address_str.replace('–ø—Ä.', ' ').replace('–ø—Ä–æ–µ–∑–¥ ', ' ')   
    address_str = address_str.replace('–±-—Ä.', ' ').replace('–±—É–ª—å–≤–∞—Ä ', ' ') 
    address_str = address_str.replace('–Ω–∞–±.', ' ').replace('–Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è ', ' ')
    address_str = address_str.replace('–ø–ª–æ—â–∞–¥—å ', '–ø–ª_')
    address_str = address_str.replace('—à.', ' ').replace('—à–æ—Å—Å–µ ', ' ')    
    address_str = address_str.replace('—Å–ø—É—Å–∫', ' ')
    address_str = address_str.replace('–ø–æ—Å.', ' ').replace('–ø–æ—Å–µ–ª–æ–∫ ', ' ')
    address_str = address_str.replace('—Å.', ' ').replace('—Å–µ–ª–æ ', ' ')
    address_str = address_str.replace('–≥.', ' ').replace('–≥–æ—Ä–æ–¥ ', ' ')
    address_str = address_str.replace('–∫–æ—Ä–ø.', '_–∫–æ—Ä–ø_').replace('–∫–æ—Ä–ø—É—Å ', '_–∫–æ—Ä–ø_').replace('–∫.', '_–∫–æ—Ä–ø_')
    address_str = address_str.replace('—Å—Ç—Ä.', '_—Å—Ç—Ä_').replace('—Å—Ç—Ä–æ–µ–Ω–∏–µ ', '_—Å—Ç—Ä_')
    address_str = address_str.replace('–ª–∏—Ç–µ—Ä–∞ ', '_–ª–∏—Ç_').replace('–ª–∏—Ç.', '_lit_')
    # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ó–∞–∫—Ä—ã—Ç —Å–ø–∏—Å–æ–∫ lookahead terms –∏ —Å–∞–º–∞ —Å—Ç—Ä–æ–∫–∞ (–¥–æ–±–∞–≤–ª–µ–Ω—ã '–ª–∏—Ç' –∏ ')' –∏ "'")
    address_str = re.sub(r'(\d+)[/\-](?!–∫–æ—Ä–ø|—Å—Ç—Ä|–ª–∏—Ç).*?(?=\s|_|$)', r'\1', address_str)
    address_str = re.sub(r'[^–∞-—è–ê-–Ø—ë–Å0-9a-zA-Z]+', '_', address_str)
    address_str = address_str.replace('_–¥_', '_') 
    address_str = address_str.replace('_–¥–æ–º_', '_')
    address_str = address_str.replace('_—É–ª_', '_') 
    address_str = address_str.replace('_–ø–µ—Ä_', '_') 
    address_str = address_str.replace('_–ø—Ä_', '_') 
    address_str = address_str.replace('_–±_—Ä_', '_')
    address_str = address_str.replace('_–Ω–∞–±_', '_')
    address_str = address_str.replace('_—à_', '_')
    address_str = address_str.replace('_—Å–ø_', '_')
    address_str = address_str.replace('_–ø–æ—Å_', '_')
    address_str = address_str.replace('_—Å_', '_')
    address_str = address_str.replace('_–≥_', '_')
    address_str = re.sub(r'_{2,}', '_', address_str)
    address_str = address_str.strip('_')
    return address_str


def process_files(source_root_folders, target_base_folder_for_files, courier_mapping, unmatched_folder_name):
    """
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ –∑–∞–¥–∞–Ω–Ω—ã—Ö –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø–∞–ø–æ–∫ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –ø–æ –∫—É—Ä—å–µ—Ä–∞–º
    –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é —Ü–µ–ª–µ–≤—É—é –ø–∞–ø–∫—É.
    """
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –¥–ª—è –Ω–µ—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Ü–µ–ª–µ–≤–æ–π –ø–∞–ø–∫–∏
    unmatched_path = os.path.join(target_base_folder_for_files, unmatched_folder_name)
    os.makedirs(unmatched_path, exist_ok=True)

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–π –∏—Å—Ö–æ–¥–Ω–æ–π –ø–∞–ø–∫–∏ —Å –ø–æ—á—Ç–æ–≤—ã–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏
    for current_source_root_folder in source_root_folders:
        print(f"\n--- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–π –ø–∞–ø–∫–∏: {current_source_root_folder} ---")
        if not os.path.exists(current_source_root_folder):
            print(f"–í–Ω–∏–º–∞–Ω–∏–µ: –ò—Å—Ö–æ–¥–Ω–∞—è –ø–∞–ø–∫–∞ '{current_source_root_folder}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º.")
            continue

        for postal_code in range(150000, 151000): 
            folder_path = os.path.join(current_source_root_folder, str(postal_code))

            if not os.path.exists(folder_path):
                continue

            for filename in os.listdir(folder_path):
                if filename.lower().endswith(".pdf"):
                    full_file_path = os.path.join(folder_path, filename)
                    
                    parts = filename.split('_', 1)
                    if len(parts) < 2:
                        print(f"–ü—Ä–æ–ø—É—Å–∫: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ (–Ω–µ—Ç –∞–¥—Ä–µ—Å–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ '_'): {filename}")
                        shutil.move(full_file_path, os.path.join(unmatched_path, filename))
                        continue
                    
                    raw_address_pdf_part = parts[1].rsplit('.', 1)[0]
                    address_from_filename = normalize_address_string(raw_address_pdf_part)

                    courier_name_from_map = courier_mapping.get(address_from_filename)
                    
                    if courier_name_from_map is not None and str(courier_name_from_map).strip(): 
                        target_courier_folder = os.path.join(target_base_folder_for_files, str(courier_name_from_map).strip())
                        target_postal_code_folder = os.path.join(target_courier_folder, str(postal_code))
                        
                        os.makedirs(target_postal_code_folder, exist_ok=True)
                        
                        destination_path = os.path.join(target_postal_code_folder, filename)
                        try:
                            shutil.move(full_file_path, destination_path)
                            print(f"–ü–µ—Ä–µ–º–µ—â–µ–Ω–æ '{filename}' –≤ '{target_postal_code_folder}'")
                        except Exception as e:
                            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ '{filename}': {e}")
                    else:
                        shutil.move(full_file_path, os.path.join(unmatched_path, filename))
    print(f"–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è {target_base_folder_for_files} –∑–∞–≤–µ—Ä—à–µ–Ω–∞.")


def sort_invoices_by_courier():
    # --- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ---
    main_target_root = r"C:\Users\User\Desktop\–ù–µ –¢–†–û–ì–ê–¢–¨ –ú–û–Æ –ü–ê–ü–ö–£" 
    
    # –ò—Å—Ö–æ–¥–Ω—ã–µ –ø–∞–ø–∫–∏ –¥–ª—è "–¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö" —Ñ–∞–π–ª–æ–≤
    source_root_folders_two_sided = [
        r"C:\Users\User\Desktop\–û–∫—Ç—è–±—Ä—å\–í–í–†\–î–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω—è—è", #–û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è —Ñ–∞–π–ª—ã
        r"C:\Users\User\Desktop\–û–∫—Ç—è–±—Ä—å\–£–î–†\–î–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω—è—è", #–û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è —Ñ–∞–π–ª—ã 
    ]
    # –¶–µ–ª–µ–≤–∞—è –ø–∞–ø–∫–∞ –¥–ª—è "–¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö" —Ñ–∞–π–ª–æ–≤
    target_base_folder_two_sided = os.path.join(main_target_root, "1. –¥–≤—É—Ö")

    # –ò—Å—Ö–æ–¥–Ω—ã–µ –ø–∞–ø–∫–∏ –¥–ª—è "–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö" —Ñ–∞–π–ª–æ–≤
    source_root_folders_one_sided = [
        r"C:\Users\User\Desktop\–û–∫—Ç—è–±—Ä—å\–í–í–†\–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è", #–û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è —Ñ–∞–π–ª—ã 
        r"C:\Users\User\Desktop\–û–∫—Ç—è–±—Ä—å\–£–î–†\–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è", #–û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è —Ñ–∞–π–ª—ã 
    ] 
    
    # –¶–µ–ª–µ–≤–∞—è –ø–∞–ø–∫–∞ –¥–ª—è "–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö" —Ñ–∞–π–ª–æ–≤
    target_base_folder_one_sided = os.path.join(main_target_root, "2. –æ–¥–Ω–æ")


    # –í–ê–ñ–ù–û: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–æ –¢–û–ß–ù–û–ï –∏–º—è –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞!
    courier_data_file = r"E:\Sort\–¥–æ–º–∞ –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º.csv"
    
    unmatched_folder_name = "–ù–µ—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ_–§–∞–π–ª—ã"

    # --- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤ (–æ–±—â–∞—è –¥–ª—è –æ–±–µ–∏—Ö —Å–æ—Ä—Ç–∏—Ä–æ–≤–æ–∫) ---
    try:
        courier_df = pd.read_csv(courier_data_file, encoding='windows-1251', sep=';') 
        address_column_name = '–ê–¥—Ä–µ—Å' 
        
        if address_column_name not in courier_df.columns or '–§–ò–û' not in courier_df.columns:
            print("–û—à–∏–±–∫–∞: CSV —Ñ–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ '–ê–¥—Ä–µ—Å' –∏/–∏–ª–∏ '–§–ò–û'.")
            print(f"–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏: {courier_df.columns.tolist()}")
            return

        courier_mapping = {}
        courier_df['–§–ò–û'] = courier_df['–§–ò–û'].fillna('').astype(str)

        for index, row in courier_df.iterrows():
            raw_csv_address = row[address_column_name]
            courier_fio = row['–§–ò–û'] 
            normalized_address = normalize_address_string(raw_csv_address)
            courier_mapping[normalized_address] = courier_fio 
        
        print("–î–∞–Ω–Ω—ã–µ –∫—É—Ä—å–µ—Ä–æ–≤ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã.")
    except FileNotFoundError:
        print(f"–û—à–∏–±–∫–∞: –§–∞–π–ª '{courier_data_file}' –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É —É–∫–∞–∑–∞–Ω –≤–µ—Ä–Ω–æ.")
        print("–¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –æ—Ç–∫—Ä—ã—Ç –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ Excel).")
        return
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ CSV —Ñ–∞–π–ª–∞: {e}")
        print("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8 –∏–ª–∏ windows-1251, –∏ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏: '–ê–¥—Ä–µ—Å', '–§–ò–û'.")
        print("–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º –ø–æ–ª–µ–π –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö.")
        return

    # --- –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤ ---
    print("\n\n--- –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –î–í–£–°–¢–û–†–û–ù–ù–ò–• —Ñ–∞–π–ª–æ–≤ ---")
    process_files(source_root_folders_two_sided, target_base_folder_two_sided, courier_mapping, unmatched_folder_name)
    
    # --- –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤ ---
    print("\n\n--- –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –û–î–ù–û–°–¢–û–†–û–ù–ù–ò–• —Ñ–∞–π–ª–æ–≤ ---")
    process_files(source_root_folders_one_sided, target_base_folder_one_sided, courier_mapping, unmatched_folder_name)
        
    print("\n\n–ü–æ–ª–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
    print(f"–î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ñ–∞–π–ª—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤: {target_base_folder_two_sided}")
    print(f"–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ñ–∞–π–ª—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤: {target_base_folder_one_sided}")
    print(f"–ù–µ—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–¥–ø–∞–ø–∫–∞—Ö '–ù–µ—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ_–§–∞–π–ª—ã'.")

# –ó–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü–∏–∏
if __name__ == "__main__":
    sort_invoices_by_courier()

```
